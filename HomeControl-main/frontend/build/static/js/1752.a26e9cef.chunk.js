"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[1752],{1752:(e,a,t)=>{t.r(a),t.d(a,{default:()=>A});var r=t(9950),s=t(5054),l=t(5082),i=t(6220),n=t(625),o=t(3816),d=t(3291),c=t(1123),x=t(4932),m=t(6174),u=t(7205),g=t(9290),h=t(4729),y=t(2623),p=t(5556);function b(e,a){let{title:t,titleId:s,...l}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},l),t?r.createElement("title",{id:s},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"}))}const v=r.forwardRef(b);function j(e,a){let{title:t,titleId:s,...l}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},l),t?r.createElement("title",{id:s},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const f=r.forwardRef(j);function w(e,a){let{title:t,titleId:s,...l}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},l),t?r.createElement("title",{id:s},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}const k=r.forwardRef(w);function N(e,a){let{title:t,titleId:s,...l}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},l),t?r.createElement("title",{id:s},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const C=r.forwardRef(N);var E=t(4414);const A=()=>{const{user:e,checkDeviceAccess:a}=(0,s.A)(),{deviceId:t}=(0,n.g)(),b=(0,n.Zp)(),[j,w]=(0,r.useState)(null),[N,A]=(0,r.useState)(!0),[L,D]=(0,r.useState)(null),[z,P]=(0,r.useState)(!1),[R,S]=(0,r.useState)(!1),[O,B]=(0,r.useState)(""),[H,I]=(0,r.useState)(!1),V={light:(0,E.jsx)(g.A,{className:"w-8 h-8 text-yellow-400"}),sensor:(0,E.jsx)(h.A,{className:"w-8 h-8 text-yellow-400"}),thermostat:(0,E.jsx)(y.A,{className:"w-8 h-8 text-yellow-400"}),camera:(0,E.jsx)(p.A,{className:"w-8 h-8 text-yellow-400"}),lock:(0,E.jsx)(v,{className:"w-8 h-8 text-yellow-400"}),default:(0,E.jsx)(h.A,{className:"w-8 h-8 text-yellow-400"})};(0,r.useEffect)((()=>{(async()=>{try{if(!await a(e,t))return void b("/unauthorized");const r=await(0,i.x7)((0,i.H9)(l.db,"devices",t));r.exists()?(w({id:r.id,...r.data()}),B(r.data().name||"Dispositivo")):b("/user/dashboard"),A(!1)}catch(L){console.error("DeviceControl: Device fetch error:",L),D("Error al cargar dispositivo"),m.oR.error("Error al cargar dispositivo"),A(!1)}})()}),[t,e,b,a]);const W=async e=>{P(!0);try{await(0,i.mZ)((0,i.H9)(l.db,"devices",t),e),w({...j,...e}),m.oR.success("Dispositivo actualizado")}catch(L){console.error("DeviceControl: Device update error:",L),D("Error al actualizar dispositivo"),m.oR.error("Error al actualizar dispositivo")}finally{P(!1)}};return N||!j?(0,E.jsx)(c.A,{children:(0,E.jsx)(x.A,{})}):(0,E.jsx)(c.A,{children:(0,E.jsx)(o.P.div,{className:"max-w-3xl mx-auto px-4 sm:px-6 md:px-8 py-6 font-sans",initial:{opacity:0},animate:{opacity:1},transition:{duration:.6},children:(0,E.jsxs)(o.P.div,{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[(0,E.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,E.jsxs)("div",{className:"flex items-center space-x-3",children:[V[j.type]||V.default,R?(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)("input",{type:"text",value:O,onChange:e=>B(e.target.value),className:"text-xl font-bold text-gray-800 dark:text-gray-200 bg-transparent border-b border-gray-300 dark:border-gray-600 focus:outline-none","aria-label":"Editar nombre del dispositivo"}),(0,E.jsx)("button",{onClick:async()=>{""!==O.trim()?(await W({name:O.trim()}),S(!1)):m.oR.error("El nombre no puede estar vac\xedo")},className:"text-yellow-400 hover:text-yellow-500","aria-label":"Guardar nombre",children:"Guardar"}),(0,E.jsx)("button",{onClick:()=>S(!1),className:"text-gray-600 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300","aria-label":"Cancelar edici\xf3n",children:"Cancelar"})]}):(0,E.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,E.jsx)("h1",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:j.name||"Dispositivo"}),(0,E.jsx)("button",{onClick:()=>S(!0),className:"text-yellow-400 hover:text-yellow-500","aria-label":"Editar nombre del dispositivo",children:(0,E.jsx)(f,{className:"w-5 h-5"})})]})]})}),L&&(0,E.jsx)(o.P.div,{className:"mb-6 p-4 bg-red-100 dark:bg-red-900/50 text-red-700 dark:text-red-400 rounded-lg text-center",role:"alert","aria-live":"polite",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},children:L}),(0,E.jsxs)("div",{className:"space-y-6",children:[(0,E.jsxs)(o.P.div,{className:"relative p-4 rounded-lg "+(j.status?"bg-green-50 dark:bg-green-900/50 border-2 border-green-500":"bg-red-50 dark:bg-red-900/50 border-2 border-red-500"),initial:{scale:1},animate:{scale:j.status?[1,1.02,1]:[1,.98,1]},transition:{duration:.3},children:[(0,E.jsx)(d.N,{children:z&&(0,E.jsx)(o.P.div,{className:"absolute inset-0 bg-gray-200 dark:bg-gray-700 bg-opacity-50 flex items-center justify-center rounded-lg",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,E.jsx)(x.A,{})})}),(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{className:"flex items-center space-x-3",children:[V[j.type]||V.default,(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Estado"}),(0,E.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Actualmente:"," ",(0,E.jsx)("span",{className:j.status?"text-green-500":"text-red-500",children:"lock"===j.type?j.status?"Bloqueado":"Desbloqueado":j.status?"Encendido":"Apagado"})]})]})]}),(0,E.jsxs)(u.dO,{checked:j.status,onChange:()=>W({status:!j.status}),className:(j.status?"bg-green-500":"bg-gray-200 dark:bg-gray-600")+" relative inline-flex items-center h-6 rounded-full w-11",disabled:z,children:[(0,E.jsxs)("span",{className:"sr-only",children:["Cambiar estado de ",j.name||"dispositivo"]}),(0,E.jsx)("span",{className:(j.status?"translate-x-6":"translate-x-1")+" inline-block w-4 h-4 transform bg-white rounded-full transition"})]})]})]}),"thermostat"===j.type?(0,E.jsxs)("div",{className:"p-4 bg-gray-100 dark:bg-gray-700 rounded-lg",children:[(0,E.jsx)("label",{htmlFor:"temperature",className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Temperatura (\xb0C)"}),(0,E.jsxs)("div",{className:"relative mt-2",children:[(0,E.jsx)("input",{type:"range",id:"temperature",value:j.temperature||20,onChange:e=>W({temperature:Number(e.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-600 accent-yellow-400",min:"10",max:"30",step:"0.5","aria-label":"Ajustar temperatura",disabled:z}),(0,E.jsxs)("div",{className:"flex justify-between mt-2",children:[(0,E.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"10\xb0C"}),(0,E.jsxs)("span",{className:"text-sm font-medium text-yellow-400",children:[j.temperature||20,"\xb0C"]}),(0,E.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"30\xb0C"})]})]})]}):(0,E.jsx)("div",{className:"p-4 bg-gray-100 dark:bg-gray-700 rounded-lg text-center",children:(0,E.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Este dispositivo no admite control de temperatura."})}),"camera"===j.type&&(0,E.jsxs)("div",{className:"p-4 bg-gray-100 dark:bg-gray-700 rounded-lg text-center",children:[(0,E.jsx)(p.A,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),(0,E.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Vista en vivo no disponible en modo demo."}),(0,E.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:"Contacte al soporte para habilitar esta funci\xf3n."})]}),(0,E.jsxs)("div",{className:"p-4 bg-gray-100 dark:bg-gray-700 rounded-lg",children:[(0,E.jsxs)("button",{onClick:()=>I(!H),className:"flex items-center justify-between w-full text-sm font-medium text-gray-700 dark:text-gray-200","aria-label":H?"Ocultar configuraci\xf3n avanzada":"Mostrar configuraci\xf3n avanzada",children:[(0,E.jsx)("span",{children:"Configuraci\xf3n Avanzada"}),H?(0,E.jsx)(k,{className:"w-5 h-5 text-yellow-400"}):(0,E.jsx)(C,{className:"w-5 h-5 text-yellow-400"})]}),(0,E.jsx)(d.N,{children:H&&(0,E.jsxs)(o.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"mt-4 space-y-4",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Historial de Actividad"}),(0,E.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"No hay datos de actividad disponibles en modo demo."})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Configuraci\xf3n Adicional"}),(0,E.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Funciones avanzadas no implementadas."})]})]})})]})]}),(0,E.jsx)("div",{className:"mt-8 flex flex-col sm:flex-row sm:space-x-4 space-y-2 sm:space-y-0",children:(0,E.jsx)(o.P.button,{onClick:()=>b("/user/dashboard"),className:"w-full sm:w-auto min-h-[48px] px-6 py-2 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Volver al dashboard",children:"Volver al Dashboard"})})]})})})}},4932:(e,a,t)=>{t.d(a,{A:()=>l});t(9950);var r=t(3816),s=t(4414);const l=()=>{const e={animate:{rotate:360,transition:{repeat:1/0,duration:1,ease:"linear"}}};return(0,s.jsx)("div",{className:"flex items-center justify-center h-screen bg-background dark:bg-gray-900","aria-label":"Cargando",children:(0,s.jsx)(r.P.div,{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full",variants:e,animate:"animate",role:"status","aria-live":"polite"})})}}}]);