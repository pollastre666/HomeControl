"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[377],{6377:(e,s,a)=>{a.r(s),a.d(s,{default:()=>m});var t=a(9950),i=a(5054),r=a(625),o=a(688),l=a(6174),n=a(6220),c=a(5082),d=a(4414);const m=()=>{const{user:e,isLoading:s,logout:a}=(0,i.A)(),m=(0,r.Zp)(),[x,h]=(0,t.useState)([]);return(0,t.useEffect)((()=>{e&&(async()=>{try{const s=(0,n.rJ)(c.db,`users/${e.uid}/activities`),a=(0,n.P)(s,(0,n.My)("timestamp","desc"),(0,n.AB)(5)),t=(await(0,n.GG)(a)).docs.map((e=>({id:e.id,action:e.data().action,time:new Date(e.data().timestamp.toDate()).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})})));h(t)}catch(s){console.error("Error fetching recent activities:",s),h([{id:1,action:"Actualiz\xf3 el horario de luces",time:"Hace 15 minutos"},{id:2,action:"Program\xf3 tarea de riego",time:"Hace 2 horas"}]),l.oR.error("Error al cargar actividad reciente")}})()}),[e]),s?(0,d.jsx)(o.A,{children:(0,d.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,d.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,d.jsxs)("svg",{className:"animate-spin h-12 w-12 text-teal-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,d.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,d.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,d.jsx)("p",{className:"text-lg font-semibold text-teal-800",children:"Cargando..."})]})})}):e?["editor","admin"].includes(e.role)?(0,d.jsx)(o.A,{children:(0,d.jsx)("main",{className:"p-6",children:(0,d.jsxs)("div",{className:"max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-8",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,d.jsx)("h1",{className:"text-3xl font-bold text-teal-800",children:"Panel del Editor"}),(0,d.jsx)("button",{onClick:a,className:"bg-red-600 text-white py-1 px-3 rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-colors duration-200",children:"Cerrar Sesi\xf3n"})]}),(0,d.jsxs)("p",{className:"text-gray-600 mb-6",children:["Bienvenido, ",null===e||void 0===e?void 0:e.username," (Rol: ",null===e||void 0===e?void 0:e.role,")"]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,d.jsxs)("div",{className:"bg-teal-50 rounded-lg p-4 shadow-md hover:shadow-lg transition-shadow",children:[(0,d.jsx)("h3",{className:"text-lg font-semibold text-teal-800",children:"Administrar Horarios"}),(0,d.jsx)("p",{className:"text-gray-600",children:"Edita los horarios de los dispositivos"}),(0,d.jsx)("button",{onClick:()=>m("/Horarios"),className:"mt-2 bg-teal-600 text-white py-1 px-3 rounded-lg hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2 transition-colors duration-200 w-full",children:"Editar"})]}),(0,d.jsxs)("div",{className:"bg-teal-50 rounded-lg p-4 shadow-md hover:shadow-lg transition-shadow",children:[(0,d.jsx)("h3",{className:"text-lg font-semibold text-teal-800",children:"Administrar Tareas"}),(0,d.jsx)("p",{className:"text-gray-600",children:"Crea y edita tareas automatizadas"}),(0,d.jsx)("button",{onClick:()=>m("/Tareas"),className:"mt-2 bg-teal-600 text-white py-1 px-3 rounded-lg hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2 transition-colors duration-200 w-full",children:"Editar"})]})]}),(0,d.jsxs)("div",{className:"bg-teal-50 rounded-lg p-6 shadow-md",children:[(0,d.jsx)("h2",{className:"text-xl font-semibold text-teal-800 mb-4",children:"Actividad Reciente"}),x.length?(0,d.jsx)("ul",{className:"space-y-3",children:x.map((e=>(0,d.jsxs)("li",{className:"flex items-center space-x-3",children:[(0,d.jsx)("span",{className:"w-2 h-2 bg-teal-600 rounded-full"}),(0,d.jsx)("p",{className:"text-gray-600",children:e.action}),(0,d.jsx)("span",{className:"text-sm text-gray-400",children:e.time})]},e.id)))}):(0,d.jsx)("p",{className:"text-gray-600",children:"No hay actividad reciente."})]})]})})}):(l.oR.error("Acceso denegado: No tienes permisos para esta p\xe1gina."),(0,d.jsx)(r.C5,{to:"/unauthorized?role=editor",replace:!0})):(l.oR.warn("Por favor, inicia sesi\xf3n para acceder a esta p\xe1gina."),(0,d.jsx)(r.C5,{to:"/login",replace:!0}))}}}]);