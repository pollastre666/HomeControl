"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[8431],{8431:(e,a,r)=>{r.r(a),r.d(a,{default:()=>u});var s=r(9950),t=r(5054),o=r(5082),i=r(6220),d=r(6174),l=r(625);const n=[{id:"luz_1",name:"Luz Sala",type:"light",status:!1,category:"Iluminaci\xf3n",image:"https://via.placeholder.com/128?text=Luz+Sala",description:"Luz LED inteligente para la sala",specs:{power:"10W",lumens:800}},{id:"enchufe_1",name:"Enchufe Cocina",type:"plug",status:!1,category:"Enchufe Inteligente",image:"https://via.placeholder.com/128?text=Enchufe+Cocina",description:"Enchufe WiFi para la cocina",specs:{maxPower:"2000W",voltage:"220V"}}];var c=r(4414);const u=()=>{const{user:e}=(0,t.A)(),a=(0,l.Zp)(),[r,u]=(0,s.useState)(""),[m,g]=(0,s.useState)(""),[p,x]=(0,s.useState)(null),[h,y]=(0,s.useState)(!1),[b,v]=(0,s.useState)(null);(0,s.useEffect)((()=>{if(m){const e=n.find((e=>e.id===m));v(e),u((null===e||void 0===e?void 0:e.name)||"")}else v(null),u("")}),[m]);return(0,c.jsx)("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,c.jsxs)("div",{className:"max-w-4xl w-full bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 space-y-8",children:[(0,c.jsx)("h2",{className:"text-3xl font-bold text-center text-gray-900 dark:text-white",children:"A\xf1adir Nuevo Dispositivo"}),(0,c.jsx)("p",{className:"text-center text-gray-600 dark:text-gray-400",children:"Selecciona un componente y personaliza tu dispositivo."}),(0,c.jsxs)("form",{onSubmit:async s=>{if(s.preventDefault(),!e)return x("Debes iniciar sesi\xf3n para a\xf1adir un dispositivo."),void d.oR.error("Debes iniciar sesi\xf3n.");if(!r||!m)return x("Por favor, completa todos los campos."),void d.oR.error("Completa todos los campos.");y(!0),x(null);try{const s=`device-${Date.now()}`,t=n.find((e=>e.id===m)),l={owner:e.uid,name:r,type:(null===t||void 0===t?void 0:t.name)||m,componentId:m,category:(null===t||void 0===t?void 0:t.category)||"Unknown",specs:(null===t||void 0===t?void 0:t.specs)||{},status:!1,createdAt:new Date};await(0,i.BN)((0,i.H9)(o.db,"devices",s),l),d.oR.success("Dispositivo a\xf1adido con \xe9xito"),u(""),g(""),v(null),a("/user/dashboard")}catch(p){const a="permission-denied"===p.code?"No tienes permiso para a\xf1adir dispositivos. Verifica tu autenticaci\xf3n o las reglas de Firestore.":`Error al a\xf1adir dispositivo: ${p.message}`;x(a),d.oR.error(a)}finally{y(!1)}},className:"space-y-6",children:[(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:"component",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Seleccionar Componente"}),(0,c.jsxs)("select",{id:"component",value:m,onChange:e=>g(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 shadow-sm focus:border-yellow-400 focus:ring-yellow-400 sm:text-sm",required:!0,children:[(0,c.jsx)("option",{value:"",children:"-- Selecciona un componente --"}),n.map((e=>(0,c.jsxs)("option",{value:e.id,children:[e.name," (",e.category,")"]},e.id)))]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Nombre del Dispositivo"}),(0,c.jsx)("input",{id:"name",type:"text",value:r,onChange:e=>u(e.target.value),placeholder:"Ej. Sensor de Sala",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 shadow-sm focus:border-yellow-400 focus:ring-yellow-400 sm:text-sm",required:!0})]})]}),p&&(0,c.jsx)("div",{className:"bg-red-100 dark:bg-red-900 border-l-4 border-red-500 dark:border-red-700 text-red-700 dark:text-red-200 p-4 rounded",children:(0,c.jsx)("p",{children:p})}),b&&(0,c.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-6 flex items-center space-x-6",children:[(0,c.jsx)("img",{src:b.image,alt:b.name,className:"w-32 h-32 object-cover rounded-lg",onError:e=>{e.target.src="https://via.placeholder.com/128"}}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:b.name}),(0,c.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:b.description})]})]}),(0,c.jsx)("div",{className:"flex justify-end",children:(0,c.jsx)("button",{type:"submit",disabled:h||!e,className:"px-6 py-3 bg-yellow-400 text-gray-900 font-semibold rounded-lg shadow-md hover:bg-yellow-500 focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:h?"A\xf1adiendo...":"A\xf1adir Dispositivo"})})]})]})})}}}]);