"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[579],{4579:(e,a,r)=>{r.r(a),r.d(a,{default:()=>m});var t=r(9950),o=r(5054),l=r(3816),s=r(625),i=r(688),n=r(4932),d=r(6174),c=r(8312),u=r(4414);const m=()=>{const{user:e,isLoading:a,updateUserProfile:r}=(0,o.A)(),m=(0,s.Zp)(),[x,y]=(0,t.useState)(null),[p,g]=(0,t.useState)({name:"",phone:"",street:"",city:"",postalCode:"",country:""});if((0,t.useEffect)((()=>{var a,r,t,o;e&&g({name:e.name||"",phone:e.phone||"",street:(null===(a=e.address)||void 0===a?void 0:a.street)||"",city:(null===(r=e.address)||void 0===r?void 0:r.city)||"",postalCode:(null===(t=e.address)||void 0===t?void 0:t.postalCode)||"",country:(null===(o=e.address)||void 0===o?void 0:o.country)||""})}),[e]),a)return(0,u.jsx)(i.A,{children:(0,u.jsx)(n.A,{})});if(!e)return(0,u.jsx)(s.C5,{to:"/login",replace:!0});const b=e=>{const{name:a,value:r}=e.target;g((e=>({...e,[a]:r}))),y(null)};return(0,u.jsx)(i.A,{children:(0,u.jsxs)(l.P.div,{className:"container mx-auto px-4 py-8 max-w-6xl",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[(0,u.jsx)("h1",{className:"text-4xl font-bold text-yellow-400 mb-8",children:"Mi Perfil - IoT Solutions"}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,u.jsx)(l.P.div,{className:"bg-white dark:bg-gray-800 shadow-lg rounded-lg p-6 h-fit",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2,duration:.6},children:(0,u.jsxs)("div",{className:"flex flex-col items-center",children:[(0,u.jsx)("div",{className:"w-24 h-24 bg-gray-200 rounded-full mb-4 flex items-center justify-center",children:(0,u.jsx)("svg",{className:"w-12 h-12 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,u.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,u.jsx)("h2",{className:"text-xl font-semibold text-gray-800 dark:text-gray-200",children:e.name||"Usuario"}),(0,u.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:e.email}),(0,u.jsx)("button",{type:"button",onClick:async()=>{try{const e=(0,c.dG)(),a=await(0,c.gf)(e,{vapidKey:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyDvVBx0r8MxX6xNe-dHdsvPdzOaORcuEk0",REACT_APP_FIREBASE_APP_ID:"1:860531471097:web:ed0f6c8638e36226092828",REACT_APP_FIREBASE_AUTH_DOMAIN:"homecontrol-dac34.firebaseapp.com",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"860531471097",REACT_APP_FIREBASE_PROJECT_ID:"homecontrol-dac34",REACT_APP_FIREBASE_STORAGE_BUCKET:"homecontrol-dac34.firebasestorage.app",REACT_APP_STRIPE_PUBLIC_KEY:"pk_test_51ROl5WRCz11UNurnDiqgkjLo3hOmSGZeRrEOvqOBtxK68hw3VolJZaIIvXSfKYBS3quOZ6wM3jOBE5GkqVY8pp0800vZNyTIAF"}.REACT_APP_FCM_VAPID_KEY});await r({fcmToken:a}),d.oR.success("Notificaciones habilitadas")}catch(e){d.oR.error("Error al habilitar notificaciones")}},className:"mt-4 px-4 py-2 bg-yellow-400 text-gray-900 font-medium rounded-lg hover:bg-yellow-500 transition-colors duration-200","aria-label":"Habilitar notificaciones push",children:e.fcmToken?"Notificaciones habilitadas":"Habilitar Notificaciones"})]})}),(0,u.jsxs)(l.P.div,{className:"md:col-span-2 bg-white dark:bg-gray-800 shadow-lg rounded-lg p-6",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.4,duration:.6},children:[x&&(0,u.jsx)("div",{className:"mb-6 p-4 bg-red-100 text-red-700 rounded-lg text-center",role:"alert","aria-live":"polite",children:x}),(0,u.jsx)("h2",{className:"text-2xl font-semibold text-yellow-400 mb-6",children:"Editar Perfil"}),(0,u.jsxs)("form",{onSubmit:async a=>{var t,o,l,s;if(a.preventDefault(),!(p.phone&&!/^[0-9]{10}$/.test(p.phone)?(y("Tel\xe9fono debe tener 10 d\xedgitos"),0):!p.postalCode||/^[0-9]{5}$/.test(p.postalCode)||(y("C\xf3digo postal debe tener 5 d\xedgitos"),0)))return;const i={name:p.name||e.name||"",phone:p.phone||e.phone||"",address:{street:p.street||(null===(t=e.address)||void 0===t?void 0:t.street)||"",city:p.city||(null===(o=e.address)||void 0===o?void 0:o.city)||"",postalCode:p.postalCode||(null===(l=e.address)||void 0===l?void 0:l.postalCode)||"",country:p.country||(null===(s=e.address)||void 0===s?void 0:s.country)||""},profileIncomplete:!1};try{await r(i),d.oR.success("Perfil actualizado correctamente"),m("/user/dashboard")}catch(n){y("Error al actualizar el perfil"),d.oR.error("Error al actualizar el perfil")}},className:"grid grid-cols-1 md:grid-cols-2 gap-6","aria-label":"Formulario de edici\xf3n de perfil",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Nombre completo"}),(0,u.jsx)("input",{type:"text",id:"name",name:"name",value:p.name,onChange:b,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-400 dark:bg-gray-700 dark:text-gray-200","aria-required":"true","aria-describedby":"name-error"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Tel\xe9fono"}),(0,u.jsx)("input",{type:"tel",id:"phone",name:"phone",value:p.phone,onChange:b,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-400 dark:bg-gray-700 dark:text-gray-200","aria-describedby":"phone-error"})]}),(0,u.jsxs)("div",{className:"md:col-span-2",children:[(0,u.jsx)("label",{htmlFor:"street",className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Direcci\xf3n"}),(0,u.jsx)("input",{type:"text",id:"street",name:"street",value:p.street,onChange:b,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-400 dark:bg-gray-700 dark:text-gray-200"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Ciudad"}),(0,u.jsx)("input",{type:"text",id:"city",name:"city",value:p.city,onChange:b,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-400 dark:bg-gray-700 dark:text-gray-200"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"postalCode",className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"C\xf3digo postal"}),(0,u.jsx)("input",{type:"text",id:"postalCode",name:"postalCode",value:p.postalCode,onChange:b,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-400 dark:bg-gray-700 dark:text-gray-200","aria-describedby":"postalCode-error"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"Pa\xeds"}),(0,u.jsx)("input",{type:"text",id:"country",name:"country",value:p.country,onChange:b,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yellow-400 dark:bg-gray-700 dark:text-gray-200"})]}),(0,u.jsx)("div",{className:"md:col-span-2 flex justify-end",children:(0,u.jsx)(l.P.button,{type:"submit",className:"px-6 py-2 bg-yellow-400 text-gray-900 font-semibold rounded-lg hover:bg-yellow-500 transition-all duration-200",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Guardar cambios de perfil",children:"Guardar Cambios"})})]})]})]})]})})}},4932:(e,a,r)=>{r.d(a,{A:()=>l});r(9950);var t=r(3816),o=r(4414);const l=()=>{const e={animate:{rotate:360,transition:{repeat:1/0,duration:1,ease:"linear"}}};return(0,o.jsx)("div",{className:"flex items-center justify-center h-screen bg-background dark:bg-gray-900","aria-label":"Cargando",children:(0,o.jsx)(t.P.div,{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full",variants:e,animate:"animate",role:"status","aria-live":"polite"})})}}}]);