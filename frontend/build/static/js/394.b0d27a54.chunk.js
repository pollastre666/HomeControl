"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[394],{2394:(e,r,o)=>{o.r(r),o.d(r,{default:()=>d});var a=o(9950),s=o(625),i=o(5054),n=o(6174),t=o(6902),l=o(4414);const c={"auth/wrong-password":"Contrase\xf1a incorrecta","auth/user-not-found":"Usuario no encontrado","auth/invalid-email":"Formato de correo inv\xe1lido","auth/invalid-credential":"Credenciales inv\xe1lidas","auth/email-already-in-use":"El correo ya est\xe1 registrado","auth/weak-password":"La contrase\xf1a debe tener al menos 6 caracteres",default:"Error de autenticaci\xf3n"},d=()=>{const[e,r]=(0,a.useState)(!0),[o,d]=(0,a.useState)({email:"",password:"",confirmPassword:""}),[u,m]=(0,a.useState)(null),[g,f]=(0,a.useState)(!1),[h,x]=(0,a.useState)(!1),[p,b]=(0,a.useState)(!1),[w,v]=(0,a.useState)(null),[y,j]=(0,a.useState)(0),{login:N,createUser:C,user:R,isLoading:k}=(0,i.A)(),S=(0,s.Zp)();if((0,a.useEffect)((()=>{if(R&&!k){console.log("Redirecting authenticated user:",R.email,"Role:",R.role);const e="admin"===R.role?"/admin/dashboard":"editor"===R.role?"/editor/dashboard":"/user/dashboard";S(e,{replace:!0})}}),[R,k,S]),(0,a.useEffect)((()=>{if(y>0){const e=setTimeout((()=>j(y-1)),1e3);return()=>clearTimeout(e)}}),[y]),k)return(0,l.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-100 to-indigo-200 flex items-center justify-center p-4",children:(0,l.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,l.jsxs)("svg",{className:"animate-spin h-12 w-12 text-indigo-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,l.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,l.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,l.jsx)("p",{className:"text-lg font-semibold text-indigo-800",children:"Cargando..."})]})});const P=e=>{const{name:r,value:o}=e.target;d((e=>({...e,[r]:o}))),m(null)},E=async()=>{if(!w)return m("No hay usuario registrado para reenviar el correo."),void n.oR.error("No hay usuario registrado para reenviar el correo.");if(y>0)n.oR.warn(`Por favor, espera ${y} segundos antes de reenviar.`);else{f(!0);try{const e={url:"https://homecontrol-dac34.web.app/login",handleCodeInApp:!0};await(0,t.gA)(w,e),console.log("Resent verification email to:",w.email,"UID:",w.uid),n.oR.success("Correo de verificaci\xf3n reenviado. Revisa tu bandeja de entrada o spam."),j(30)}catch(e){console.error("Error resending verification email:",e.code,e.message);const r="Error al reenviar el correo de verificaci\xf3n: "+e.message;m(r),n.oR.error(r)}finally{f(!1)}}};return p?(0,l.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-100 to-indigo-200 flex items-center justify-center p-4",children:(0,l.jsxs)("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8 text-center",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:"Verifica tu Correo"}),(0,l.jsxs)("p",{className:"text-gray-600 mb-6",children:["Te hemos enviado un correo de verificaci\xf3n a ",(0,l.jsx)("strong",{children:o.email}),". Por favor, verifica tu correo antes de iniciar sesi\xf3n. Revisa tu bandeja de spam si no lo encuentras."]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("button",{onClick:E,disabled:g||y>0,className:"bg-green-600 text-white py-2.5 px-6 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-all disabled:bg-green-400 disabled:cursor-not-allowed",children:g?"Enviando...":y>0?`Reenviar en ${y}s`:"Reenviar Correo de Verificaci\xf3n"}),(0,l.jsx)("button",{onClick:()=>{b(!1)},className:"bg-indigo-600 text-white py-2.5 px-6 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all",children:"Volver a Iniciar Sesi\xf3n"})]})]})}):(0,l.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-100 to-indigo-200 flex items-center justify-center p-4",children:(0,l.jsxs)("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-6 text-center",children:e?"Iniciar Sesi\xf3n":"Crear Cuenta"}),u&&(0,l.jsx)("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg text-sm",role:"alert",children:u}),(0,l.jsxs)("form",{onSubmit:async a=>{a.preventDefault(),f(!0),m(null);const{email:s,password:i,confirmPassword:l}=o;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.trim()))return m("Formato de correo inv\xe1lido"),n.oR.error("Formato de correo inv\xe1lido"),void f(!1);if(e)try{console.log("Submitting login form with:",s.trim());const e=await N({email:s.trim(),password:i});console.log("Login response:",e),n.oR.success("Inicio de sesi\xf3n exitoso")}catch(u){console.error("Login error:",u.code,u.message);const e=c[u.code]||`${c.default}: ${u.message}`;m(e),n.oR.error(e)}finally{f(!1)}else{if(i!==l)return m("Las contrase\xf1as no coinciden"),n.oR.error("Las contrase\xf1as no coinciden"),void f(!1);if(i.length<6)return m("La contrase\xf1a debe tener al menos 6 caracteres"),n.oR.error("La contrase\xf1a debe tener al menos 6 caracteres"),void f(!1);try{console.log("Submitting signup form with:",s.trim());const e=await C(s.trim(),i);console.log("Signup response:",{uid:e.uid,email:e.email,emailVerified:e.emailVerified}),v(e);try{const r={url:"https://homecontrol-dac34.web.app/login",handleCodeInApp:!0};await(0,t.gA)(e,r),console.log("Verification email sent successfully to:",s.trim(),"UID:",e.uid),console.log("Action code settings:",r),n.oR.success("Cuenta creada. Por favor, verifica tu correo electr\xf3nico.")}catch(g){console.error("Error sending verification email:",g.code,g.message);const e="Error al enviar el correo de verificaci\xf3n: "+g.message;throw m(e),n.oR.error(e),g}b(!0),d({email:"",password:"",confirmPassword:""}),r(!0),j(30)}catch(u){console.error("Signup error:",u.code,u.message);const e=c[u.code]||`${c.default}: ${u.message}`;m(e),n.oR.error(e)}finally{f(!1)}}},noValidate:!0,className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Correo Electr\xf3nico"}),(0,l.jsx)("input",{type:"email",id:"email",name:"email",value:o.email,onChange:P,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all disabled:bg-gray-100",placeholder:"email@dominio.com",required:!0,disabled:g})]}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Contrase\xf1a"}),(0,l.jsx)("input",{type:h?"text":"password",id:"password",name:"password",value:o.password,onChange:P,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all disabled:bg-gray-100",placeholder:"******",required:!0,disabled:g}),(0,l.jsx)("button",{type:"button",onClick:()=>x(!h),className:"absolute right-3 top-9 text-gray-600 focus:outline-none",children:h?"Ocultar":"Mostrar"})]}),!e&&(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmar Contrase\xf1a"}),(0,l.jsx)("input",{type:h?"text":"password",id:"confirmPassword",name:"confirmPassword",value:o.confirmPassword,onChange:P,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all disabled:bg-gray-100",placeholder:"******",required:!0,disabled:g})]}),(0,l.jsx)("button",{type:"submit",disabled:g,className:"w-full bg-indigo-600 text-white py-2.5 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all disabled:bg-indigo-400 disabled:cursor-not-allowed flex items-center justify-center",children:g?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,l.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,l.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e?"Autenticando...":"Creando cuenta..."]}):e?"Iniciar Sesi\xf3n":"Crear Cuenta"})]}),(0,l.jsxs)("p",{className:"mt-4 text-center text-sm text-gray-600",children:[e?"\xbfNo tienes una cuenta?":"\xbfYa tienes una cuenta?",(0,l.jsx)("button",{type:"button",onClick:()=>{r(!e),m(null),d({email:"",password:"",confirmPassword:""}),b(!1)},className:"ml-1 text-indigo-600 hover:text-indigo-800 font-medium",children:e?"Crear una cuenta":"Iniciar sesi\xf3n"})]})]})})}}}]);